# ğŸš€ í†µí•© ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ì„¤ì¹˜ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” Proxmox í™˜ê²½ì—ì„œ Prometheus + Grafana + Node Exporterë¥¼ ì‚¬ìš©í•œ í†µí•© ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶• ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

## ğŸ¯ ì‹œìŠ¤í…œ êµ¬ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ê°œë°œ ì„œë²„     â”‚    â”‚   VM ì„œë²„ë“¤     â”‚    â”‚   ì›¹ ì½˜ì†”      â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Prometheus  â”‚â—„â”€â”€â”€â”€â”¤ â”‚Node Exporterâ”‚ â”‚    â”‚ â”‚ Flask App  â”‚ â”‚
â”‚ â”‚   :9090     â”‚ â”‚    â”‚ â”‚   :9100     â”‚ â”‚    â”‚ â”‚             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”‚   Grafana   â”‚ â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”‚   :3000     â”‚ â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”‚Node Exporterâ”‚ â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”‚   :9100     â”‚ â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ ì„¤ì¹˜ ë‹¨ê³„

### **1ë‹¨ê³„: ê°œë°œ ì„œë²„ì— ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ì„¤ì¹˜**

```bash
# ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x install_monitoring_system.sh

# í†µí•© ì„¤ì¹˜ ì‹¤í–‰
sudo ./install_monitoring_system.sh
```

**ì„¤ì¹˜ë˜ëŠ” ì„œë¹„ìŠ¤:**
- Prometheus (í¬íŠ¸ 9090)
- Grafana (í¬íŠ¸ 3000)
- Node Exporter (í¬íŠ¸ 9100)
- Ansible ì„¤ì •

### **2ë‹¨ê³„: ì„¤ì¹˜ í›„ ìë™ ì„¤ì •**

```bash
# í›„ì²˜ë¦¬ ì„¤ì • ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x setup_monitoring_post_install.sh

# ìë™ ì„¤ì • ì‹¤í–‰
sudo ./setup_monitoring_post_install.sh
```

**ìë™ ì„¤ì • ë‚´ìš©:**
- Prometheus ë°ì´í„° ì†ŒìŠ¤ ì¶”ê°€
- ê¸°ë³¸ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ ìƒì„±
- ì•Œë¦¼ ê·œì¹™ í…œí”Œë¦¿ ìƒì„±

### **3ë‹¨ê³„: ë‹¤ë¥¸ ì„œë²„ë“¤ì— Node Exporter ì„¤ì¹˜**

```bash
# SSH í‚¤ ì„¤ì • (í•„ìš”ì‹œ)
ssh-keygen -t rsa -b 4096
ssh-copy-id root@192.168.0.10
ssh-copy-id root@192.168.0.11
# ... ê¸°íƒ€ ì„œë²„ë“¤

# Ansibleë¡œ ì¼ê´„ ì„¤ì¹˜
ansible-playbook -i /etc/ansible/hosts ansible/install_node_exporter.yml
```

## ğŸ”§ ì„¤ì • íŒŒì¼

### **Prometheus ì„¤ì •** (`/etc/prometheus/prometheus.yml`)

```yaml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  - job_name: 'node-exporter'
    static_configs:
      - targets: ['192.168.0.10:9100']
      - targets: ['192.168.0.11:9100']
      # ... ê¸°íƒ€ ì„œë²„ë“¤
    scrape_interval: 10s
    metrics_path: /metrics
```

### **Grafana ì„¤ì •** (`/etc/grafana/grafana.ini`)

```ini
[server]
http_addr = 0.0.0.0
http_port = 3000

[security]
admin_user = admin
admin_password = admin123

[database]
type = sqlite3
path = /var/lib/grafana/grafana.db
```

## ğŸ“Š ì ‘ì† ì •ë³´

### **ê¸°ë³¸ ì ‘ì† ì •ë³´**
- **Grafana**: http://ì„œë²„IP:3000
- **Prometheus**: http://ì„œë²„IP:9090
- **Node Exporter**: http://ì„œë²„IP:9100

### **ê¸°ë³¸ ê³„ì •**
- **ì‚¬ìš©ì**: admin
- **ë¹„ë°€ë²ˆí˜¸**: admin123

## ğŸ¨ ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ

ì„¤ì¹˜ í›„ ìë™ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ëŒ€ì‹œë³´ë“œ:

1. **CPU ì‚¬ìš©ë¥ **: ëª¨ë“  ì„œë²„ì˜ CPU ì‚¬ìš©ë¥  ê·¸ë˜í”„
2. **ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ **: ëª¨ë“  ì„œë²„ì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ê·¸ë˜í”„
3. **ë””ìŠ¤í¬ ì‚¬ìš©ë¥ **: ëª¨ë“  ì„œë²„ì˜ ë””ìŠ¤í¬ ì‚¬ìš©ë¥  ê·¸ë˜í”„
4. **ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½**: ëª¨ë“  ì„œë²„ì˜ ë„¤íŠ¸ì›Œí¬ ì†¡ìˆ˜ì‹  ê·¸ë˜í”„

## ğŸš¨ ì•Œë¦¼ ì„¤ì •

### **ê¸°ë³¸ ì•Œë¦¼ ê·œì¹™**
- **CPU ì‚¬ìš©ë¥ **: 80% ì´ìƒ ì‹œ ê²½ê³ 
- **ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ **: 85% ì´ìƒ ì‹œ ê²½ê³ 

### **ì•Œë¦¼ ì±„ë„ ì„¤ì •**
Grafana ì›¹ UIì—ì„œ ë‹¤ìŒ ê²½ë¡œë¡œ ì„¤ì •:
- Alerting > Notification channels > Add channel

## ğŸ” ë¬¸ì œ í•´ê²°

### **ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸**
```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
sudo systemctl status prometheus grafana-server node_exporter

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸ í™•ì¸
sudo journalctl -u prometheus -f
sudo journalctl -u grafana-server -f
sudo journalctl -u node_exporter -f
```

### **í¬íŠ¸ í™•ì¸**
```bash
# ì‚¬ìš© ì¤‘ì¸ í¬íŠ¸ í™•ì¸
sudo netstat -tlnp | grep -E ':(9090|3000|9100)'

# ë˜ëŠ” ss ëª…ë ¹ì–´ ì‚¬ìš©
sudo ss -tlnp | grep -E ':(9090|3000|9100)'
```

### **ë°©í™”ë²½ ì„¤ì •**
```bash
# RedHat/CentOS/Rocky
sudo firewall-cmd --permanent --add-port=9090/tcp
sudo firewall-cmd --permanent --add-port=3000/tcp
sudo firewall-cmd --permanent --add-port=9100/tcp
sudo firewall-cmd --reload

# Ubuntu/Debian
sudo ufw allow 9090/tcp
sudo ufw allow 3000/tcp
sudo ufw allow 9100/tcp
```

## ğŸ“ˆ í™•ì¥ ë° ì»¤ìŠ¤í„°ë§ˆì´ì§•

### **ì¶”ê°€ ë©”íŠ¸ë¦­ ìˆ˜ì§‘**
- **MySQL Exporter**: ë°ì´í„°ë² ì´ìŠ¤ ë©”íŠ¸ë¦­
- **Nginx Exporter**: ì›¹ ì„œë²„ ë©”íŠ¸ë¦­
- **Custom Exporter**: ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ ë©”íŠ¸ë¦­

### **ëŒ€ì‹œë³´ë“œ ì»¤ìŠ¤í„°ë§ˆì´ì§•**
- Grafana ì›¹ UIì—ì„œ ëŒ€ì‹œë³´ë“œ í¸ì§‘
- ì¶”ê°€ íŒ¨ë„ ë° ê·¸ë˜í”„ ìƒì„±
- ì•Œë¦¼ ê·œì¹™ ì¶”ê°€

### **ë°±ì—… ë° ë³µêµ¬**
```bash
# Prometheus ë°ì´í„° ë°±ì—…
sudo tar -czf prometheus_backup_$(date +%Y%m%d).tar.gz /var/lib/prometheus

# Grafana ì„¤ì • ë°±ì—…
sudo tar -czf grafana_backup_$(date +%Y%m%d).tar.gz /etc/grafana /var/lib/grafana
```

## ğŸš€ ìš´ì˜ í™˜ê²½ ì ìš©

### **í”„ë¡œë•ì…˜ ê³ ë ¤ì‚¬í•­**
1. **ë³´ì•ˆ**: ê¸°ë³¸ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
2. **ë°±ì—…**: ì •ê¸°ì ì¸ ë°ì´í„° ë°±ì—…
3. **ëª¨ë‹ˆí„°ë§**: ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ìì²´ ëª¨ë‹ˆí„°ë§
4. **í™•ì¥ì„±**: ë°ì´í„°ë² ì´ìŠ¤ ì „í™˜ (PostgreSQL/MySQL)
5. **ê³ ê°€ìš©ì„±**: í´ëŸ¬ìŠ¤í„° êµ¬ì„±

### **ì„±ëŠ¥ ìµœì í™”**
- Prometheus ìŠ¤í† ë¦¬ì§€ ì„¤ì • ì¡°ì •
- Grafana ìºì‹± ì„¤ì •
- ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ê°„ê²© ì¡°ì •

## ğŸ“š ì°¸ê³  ìë£Œ

- [Prometheus ê³µì‹ ë¬¸ì„œ](https://prometheus.io/docs/)
- [Grafana ê³µì‹ ë¬¸ì„œ](https://grafana.com/docs/)
- [Node Exporter GitHub](https://github.com/prometheus/node_exporter)
- [Ansible ê³µì‹ ë¬¸ì„œ](https://docs.ansible.com/)

## ğŸ¤ ì§€ì› ë° ë¬¸ì˜

ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ì¶”ê°€ ë„ì›€ì´ í•„ìš”í•œ ê²½ìš°:
1. ë¡œê·¸ íŒŒì¼ í™•ì¸
2. ì„œë¹„ìŠ¤ ìƒíƒœ ì ê²€
3. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
4. ë°©í™”ë²½ ì„¤ì • í™•ì¸

